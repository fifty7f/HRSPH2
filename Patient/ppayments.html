<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Health Record System | Dashboard </title>

    <link href="/Staff/img/favicon.ico" rel="icon" type="image/x-icon">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Gothic+A1" rel="stylesheet">

	<link href="/Staff/css/theme.css" rel="stylesheet" type="text/css" media="all" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" />

	<!--Firebase Script(may need to move to the bottom of body, if web is slow.)-->
    <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-auth.js"></script>

	<!--Custom Calender Imported from boostrap-->
	<link href="/dist/assets/plugins/custom/fullcalendar/fullcalendar.bundle.css" rel="stylesheet" type="text/css" />

	<!--Global Stylesheets Bundle(boostrap)-->
	<link href="/dist/assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
	<link href="/dist/assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
	
</head>

<body>
	<div class="layout layout-nav-top">
		<div class="navbar navbar-expand-lg bg-dark navbar-dark sticky-top">
			<a class="navbar-brand" href="/Staff/sdashboard.html">
        <img alt="Pipeline" src="/Staff/img/logo.svg" />
      </a>
      <div class="d-flex align-items-center">
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="d-block d-lg-none ml-2">
            <div class="dropdown">
              <a href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <img alt="Image" src="/Staff/img/webber.jpeg" class="avatar" />
                </a>
                <div class="dropdown-menu dropdown-menu-right">
                  <!--<a href="Staff/nav-side-user.html" class="dropdown-item">Profile</a>-->
                  <button class="dropdown-item" onclick="logout()">Logout</button>
                  <!--<a href="Main.html" class="dropdown-item">Log Out</a>-->
                </div>
            </div>
          </div>
      </div>
      <!--Nav Bar Start-->
      <div class="collapse navbar-collapse justify-content-between" id="navbar-collapse">
        <ul class="navbar-nav">
          <li class="nav-item">
          <a class="nav-link" href="/Staff/sdashboard.html">Home</a>
          </li>
          <li class="nav-item">
          <a class="nav-link" href="/Staff/spatient.html">Patients</a>
          </li>
          <li class="nav-item">
          <a class="nav-link" href="/Staff/spatientlogs.html">Patients Log</a>
          </li>
          <li class="nav-item">
          <a class="nav-link" href="/Staff/smedications.html">Medication</a>
          </li>
          <li class="nav-item">
          <a class="nav-link" href="/Staff/spayments.html">Payment</a>
          </li>
        </ul>
        <div class="dropdown">
          <a href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <img alt="Image" src="/Staff/img/webber.jpeg" class="avatar" />
          </a>
          <div class="dropdown-menu dropdown-menu-right">
            <!--<a href="Staff/nav-side-user.html" class="dropdown-item">Profile</a>-->
            <button class="dropdown-item" onclick="logout()">Logout</button>
            <!--<a href="Main.html" class="dropdown-item">Log Out</a>-->
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="main-container">
    <div class="subHeader">
      <h3 class="text-center" style="font-size: 3rem;">Make a Payment</h3>
    </div>
  </div>
  <div class="container col-8 my-5 br-2 rounded">
    <div class="row g-3">
      <div class="col-4 order-md-last">
        <h4 class="d-flex justify-content-between align-item-center">
          <span>Balance Due</span>
        </h4>
        <ul class="list-group">
          <li class="list-group-item d-flex justify-content-between">
            <div>
                <input type="description" id="dueFor" placeholder="Payment For" class="form-control">
            </div>
          </li>
            <li class="list-group-item d-flex justify-content-between">
              <div>
                <h6>Total Due ($)</h6>
              </div>
              <input type="price" name="Due" id="due" class="form-control" placeholder="$$.$$">
            </li>
        </ul>
      </div>
      <div class="col-8">
        <h4>Billing Address</h4>
        <form>
          <div class="row">
            <div class="col-6">
              <label class="form-label" for="firstname">First Name</label>
              <input type="text" id="" class="form-control">
             </div>
            <div class="col-6">
              <label class="form-label" for="lastname">Last name</label>
              <input type="text" id="lastname" class="form-control">
            </div>
            <div class="col-12">
              <label class="form-label" for="email">Email
              <span class="text-muted"> (Optional)</span>
              </label>
              <input type="text" id="email" class="form-control">
            </div>
            <div class="col-12">
              <label class="form-label" for="address">Address </label>
              <input type="text" id="address" class="form-control">
            </div>
            <div class="col-5">
              <label class="form-label" for="country">Country </label>
              <select class="form-select" id="country">
                  <option>Choose</option>
                  <option>USA</option>
                </select>
              </div>
              <div class="col-4">
                <label class="form-label" for="state">State </label>
                <select class="form-select" id="state">
                  <option>Choose</option>
                  <option>PA</option>
                  <option>NY</option>
                </select>
              </div>
              <div class="col-3">
                <label class="form-label" for="zip">Zip </label>
                <input type="text" id="zip" class="form-control">
              </div>
            </div>
            <hr>
            <div class="form-check">
              <input type="checkbox" class="form-check-input">
              <label class="form-check-label">Shipping address is the same as my billing address</label>
            </div>
            <hr>
            <h4>Payment</h4>
            <div class="form-check">
              <input type="radio" class="form-check-input">
              <label class="form-check-label">Credit Card</label>
            </div>
            <div class="form-check">
              <input type="radio" class="form-check-input">
              <label class="form-check-label">Debit Card</label>
            </div>
            <div class="row">
              <div class="col-6">
                <label class="form-label" for="cardname">Name on Card </label>
                <input type="text" id="name" class="form-control">
                <small class="text-muted">Full name as displayed on card</small>
              </div>
              <div class="col-6">
                <label class="form-label" for="creditcard">Credit Card Number </label>
                <input type="text" id="creditcard" class="form-control">
              </div>
              <div class="col-3">
                <label class="form-label" for="expiration">Expiration </label>
                <input type="text" id="expiration" class="form-control">
              </div>
              <div class="col-3">
                <label class="form-label" for="cvv">CVV </label>
                <input type="text" id="cvv" class="form-control">
                </div>
              </div>
              <hr>
              <button type="submit" class="btn btn-primary btn-block mb-4" id="sub">Continue To Checkout</button>
            </div>
          </div>
        </form>
      </div>

      <div class="subHeader">
        <h3 class="text-center" style="font-size: 3rem;">Payment History</h3>
      </div>
      <div class="table">
        <table id="example" class="display table-primary" style="width:100%" >
          <thead>
            <tr>
              <th>Date</th>
              <th>Amount</th>
              <th>For</th>
            </tr>
          </thead>
          <tbody id="tbody1"></tbody>
          <tfoot>
            <tr>
              
              <th>Date</th>
              <th>Amount</th>
              <th>F</th>
              <th>For</th>
            </tr>
          </tfoot>
      </table>
      </div>
        <div class="pad"></div>
    </div>
    </main>
    

    <!--CrudFunctionStarts-->
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
      import { getDatabase, ref, set, child, get, onValue } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyCIgyOP_bPFqZsA_a51sQ6rQNty-YzLpCo",
        authDomain: "username-1-479ae.firebaseapp.com",
        databaseURL: "https://username-1-479ae-default-rtdb.firebaseio.com",
        projectId: "username-1-479ae",
        storageBucket: "username-1-479ae.appspot.com",
        messagingSenderId: "992632152965",
        appId: "1:992632152965:web:bda3f8c3863f1080405aec",
        measurementId: "G-PKDNLED6JY"
      };
    
      // Declare variables
      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);
      const dbRef = ref(getDatabase(app));
      let tbody = document.getElementById('tbody1')


      //Write to RTDB
      document.getElementById("sub").addEventListener('click', function writeUserData( name, due, dueFor, date) {
        name = document.getElementById("name").value
        due = document.getElementById("due").value 
        dueFor = document.getElementById("dueFor").value 
        date= document.getElementById("date").value 

        set(ref(db, 'PaymentTransaction/' + name), {
          name: name,
          due: due,
          date: date,
          dueFor: dueFor
      }).then({

      }); }
      )
      
      //Filling the data
      function AddDataToTable(name, due, dueFor, date){
          let trow = document.createElement('tr');
          let td1 = document.createElement('td');
          let td2 = document.createElement('td');
          let td3 = document.createElement('td');
          let td4 = document.createElement('td');
          let td5 = document.createElement('td');

          td2.innerHTML = name;
          td4.innerHTML = due;
          td5.innerHTML = dueFor;
          td6.innerHTML = date;

          trow.appendChild(td1);
          trow.appendChild(td2);
          trow.appendChild(td3);
          trow.appendChild(td4);
          trow.appendChild(td5);


          tbody.appendChild(trow); 
      }

      function AddAllItemsToTable(PaymentTransaction){
          tbody.innerHTML='';
          var counter = 0;
          PaymentTransaction.forEach(element => {
              console.log('AddAllItemsToTable: ', element);
              AddDataToTable(element.name, element.due, element.dueFor, element.pcp, element.date);
              counter++;
              if (PaymentTransaction.length === counter) {
                  addDataTable()
              }
          });
      }

      function addDataTable() {
          $(document).ready( function () {
              $('#myTable').DataTable();
          });
      }

      //Get the data from firebase
      function GetAllData(){
          const dbRefPaymentTransaction = ref(db, 'PaymentTransaction/');

          onValue(dbRefPaymentTransaction, (snapshot) => {
              var PaymentTransaction = [];
              snapshot.forEach((childSnapshot) => {
                  const childKey = childSnapshot.key;
                  const childData = childSnapshot.val();
                  console.log(childData);
                  PaymentTransaction.push(childSnapshot.val())
                  // ...
              });
              AddAllItemsToTable(PaymentTransaction);
          }, {
          onlyOnce: true
          });
      }

      window.onload = GetAllData;
      
    </script>
    <!--CrudFunctionEnds-->


    
    <!-- Required vendor scripts (Do not remove) -->
    <script type="text/javascript" src="/Staff/js/jquery.min.js"></script>
    <script type="text/javascript" src="/Staff/js/popper.min.js"></script>
    <script type="text/javascript" src="/Staff/js/bootstrap.js"></script>

    <!--LogoutFunction-->
    <script src="/Firebase/main.js"></script>

    <script src="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css"></script>

    <!--end::Main-->
    <script>var hostUrl = "assets/";</script>
    <!--begin::Javascript-->
    <!--begin::Global Javascript Bundle(used by all pages)-->
    <script src="/dist/assets/plugins/global/plugins.bundle.js"></script>
    <script src="/dist/assets/js/scripts.bundle.js"></script>
    <!--end::Global Javascript Bundle-->
    <!--begin::Page Custom Javascript(used by this page)-->
    <script src="/dist/assets/js/custom/widgets.js"></script>
    <!--end::Page Custom Javascript-->
    <!--end::Javascript-->
  </body>

</html>